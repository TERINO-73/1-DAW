/*AQUI EMPIEZA EL SCRIPT DE JESUS TERINO RODRIGUEZ */
/*REPRESENTACION TABULAR DEL MODELO FISICO */

CREATE TABLE EQUIPO 
(
CODIGO_TROFEOS NUMBER(2) NOT NULL,
DIA_DEL_AÑO DATE NOT NULL,
N_TROFEOS NUMBER(2) NOT NULL,
N_VICTORIAS NUMBER(2) NOT NULL,
N_EMPATES NUMBER(2) NOT NULL,
N_DERROTAS NUMBER(2) NOT NULL,
CONSTRAINT PK_EQUIPO_MODIFICADO PRIMARY KEY (CODIGO_TROFEOS, DIA_DEL_AÑO)
);


CREATE TABLE JUGADORES
(
    DORSAL NUMBER(2) NOT NULL PRIMARY KEY,
    APELLIDOS VARCHAR2(55) NOT NULL,
    SALARIO NUMBER(6) NOT NULL,
    BONIFICACIONES NUMBER(6),
    DURACION_CONTRATO NUMBER(2) NOT NULL,
    NOMBRE VARCHAR2(25) NOT NULL
);



CREATE TABLE ENTRENADOR
(
N_IDENTIFICADOR NUMBER(2) NOT NULL PRIMARY KEY,
NOMBRE VARCHAR2(25) NOT NULL,
APELLIDOS VARCHAR2(55) NOT NULL
);


CREATE TABLE ESTADISTICAS
(
N_PARTIDO NUMBER(2) NOT NULL PRIMARY KEY,
TIEMPO_JUGADO NUMBER(2),
PASES_COMPLETADOS NUMBER(3) NOT NULL,
POSESIONES_RECUPERADAS NUMBER(2),
POSESIONES_PERDIDAS NUMBER(2),
DISTANCIA_RECORRIDA NUMBER(2) NOT NULL,
GOLES NUMBER(2)
);


CREATE TABLE EQUIPO_DIRECTIVO 
(
N_IDENTIFICADOR NUMBER(2) NOT NULL PRIMARY KEY,
RESPONSABILIDAD VARCHAR2(15) NOT NULL,
NOMBRE VARCHAR2(25) NOT NULL,
APELLIDOS VARCHAR2(55) NOT NULL
);


CREATE TABLE PARTIDOS
(
CODIGO_PARTIDOS NUMBER(2) NOT NULL PRIMARY KEY,
DIA_PARTIDO DATE NOT NULL,
DURACION NUMBER(2) NOT NULL,
EQUIPO_CONTRARIO VARCHAR2(20),
CONSTRAINT UNQ_PARTIDOS_MODIFICADO UNIQUE (EQUIPO_CONTRARIO)
);


CREATE TABLE ENTRADA
(
N_ENTRADA NUMBER(5) NOT NULL PRIMARY KEY,
NOMBRE_COMPRADOR VARCHAR2(20) NOT NULL,
PRECIO NUMBER(3) NOT NULL,
ZONA VARCHAR2(20) NOT NULL,
N_ASIENTO NUMBER(5) NOT NULL
);


CREATE TABLE PLANTILLA_JUGADORES 
(
ID_JUGADOR NUMBER(5) PRIMARY KEY,
NOMBRE VARCHAR2(25) NOT NULL,
APELLIDOS VARCHAR2(55) NOT NULL,
POSICION VARCHAR2(20) NOT NULL,
FECHA_NACIMIENTO DATE NOT NULL,
NACIONALIDAD VARCHAR2(20) NOT NULL,
PIE_DOMINANTE VARCHAR2(1) NOT NULL,
VALOR_MERCADO NUMBER(6),
EQUIPO_ACTUAL VARCHAR2(30),
EQUIPO_JOVEN VARCHAR2(30),
AGENTE VARCHAR2(50)
);

CREATE TABLE HISTORIAL_PARTIDOS 
(
ID_PARTIDO NUMBER(5) PRIMARY KEY,
 FECHA_PARTIDO DATE NOT NULL,
HORA_PARTIDO DATE NOT NULL,
COMPETICION VARCHAR2(30) NOT NULL,
JORNADA NUMBER(2),
EQUIPO_LOCAL VARCHAR2(30) NOT NULL,
EQUIPO_VISITANTE VARCHAR2(30) NOT NULL,
MARCADOR_LOCAL NUMBER(2),
MARCADOR_VISITANTE NUMBER(2),
ESTADIO VARCHAR2(30),
ARBITRO VARCHAR2(30)
);

CREATE TABLE TARJETAS_AMARILLAS_ROJAS 
(
ID_SANCION NUMBER(5) PRIMARY KEY,
ID_PARTIDO NUMBER(5) NOT NULL,
ID_JUGADOR NUMBER(5) NOT NULL,
MINUTO NUMBER(3) NOT NULL,
TIPO_TARJETA VARCHAR2(10) NOT NULL,
MOTIVO VARCHAR2(255)
);


CREATE TABLE LESIONES_JUGADORES 
(
ID_LESION NUMBER(5) PRIMARY KEY,
ID_JUGADOR NUMBER(5) NOT NULL,
FECHA_LESION DATE NOT NULL,
TIPO_LESION VARCHAR2(50) NOT NULL,
GRAVEDAD VARCHAR2(10) NOT NULL,
TIEMPO_BAJA NUMBER(3),
PARTE_CUERPO_AFECTADA VARCHAR2(50)
);

CREATE TABLE CUENTAS_BANCARIAS 
(
ID_CUENTA NUMBER(5) PRIMARY KEY,
TITULAR VARCHAR2(50) NOT NULL,
IBAN VARCHAR2(34) NOT NULL,
ENTIDAD VARCHAR2(30) NOT NULL,
SWIFT VARCHAR2(12),
SALDO NUMBER(10,2),
TIPO_CUENTA VARCHAR2(20)
);

/*AÑADIR,CAMBIAR Y ELIMINAR CAMPOS*/


ALTER TABLE PLANTILLA_JUGADORES
RENAME COLUMN FECHA_NACIMIENTO TO FECHA_NACIMIENTO_MAYUS;

ALTER TABLE PLANTILLA_JUGADORES
DROP COLUMN PIE_DOMINANTE;

ALTER TABLE PLANTILLA_JUGADORES
ADD EMAIL VARCHAR2(50);




ALTER TABLE HISTORIAL_PARTIDOS
RENAME COLUMN HORA_PARTIDO TO HORA_PARTIDO_MAYUS;

ALTER TABLE HISTORIAL_PARTIDOS
DROP COLUMN JORNADA;

ALTER TABLE HISTORIAL_PARTIDOS
ADD CIUDAD VARCHAR2(30);



ALTER TABLE TARJETAS_AMARILLAS_ROJAS
RENAME COLUMN TIPO_TARJETA TO TIPO_TARJETA_MAYUS;

ALTER TABLE TARJETAS_AMARILLAS_ROJAS
DROP COLUMN MOTIVO;

ALTER TABLE TARJETAS_AMARILLAS_ROJAS
ADD EXPULSION VARCHAR2(1) DEFAULT 'N';




ALTER TABLE LESIONES_JUGADORES
RENAME COLUMN TIPO_LESION TO TIPO_LESION_MAYUS;

ALTER TABLE LESIONES_JUGADORES
DROP COLUMN PARTE_CUERPO_AFECTADA;

ALTER TABLE LESIONES_JUGADORES
ADD FECHA_RECUPERACION DATE;




ALTER TABLE CUENTAS_BANCARIAS
RENAME COLUMN IBAN TO IBAN_MAYUS;

ALTER TABLE CUENTAS_BANCARIAS
DROP COLUMN SWIFT;

ALTER TABLE CUENTAS_BANCARIAS
ADD TIPO_MOVIMIENTO VARCHAR2(20);

/*AÑADIR,QUITAR Y CAMBIAR RESTRICCIONES */


ALTER TABLE PLANTILLA_JUGADORES
MODIFY NOMBRE VARCHAR2(25) NOT NULL,
MODIFY APELLIDOS VARCHAR2(55) NOT NULL,
MODIFY POSICION VARCHAR2(20) NOT NULL,
MODIFY FECHA_NACIMIENTO DATE NOT NULL,
MODIFY NACIONALIDAD VARCHAR2(20) NOT NULL;

ALTER TABLE PLANTILLA_JUGADORES
MODIFY VALOR_MERCADO NUMBER(6,2);

ALTER TABLE PLANTILLA_JUGADORES
MODIFY EQUIPO_ACTUAL VARCHAR2(30) CONSTRAINT EQ_ACTUAL_LENGTH CHECK (LENGTH(EQUIPO_ACTUAL) <= 30),
MODIFY EQUIPO_JOVEN VARCHAR2(30) CONSTRAINT EQ_JOVEN_LENGTH CHECK (LENGTH(EQUIPO_JOVEN) <= 30),
MODIFY AGENTE VARCHAR2(50) CONSTRAINT AGENTE_LENGTH CHECK (LENGTH(AGENTE) <= 50);


ALTER TABLE HISTORIAL_PARTIDOS
MODIFY FECHA_PARTIDO DATE NOT NULL,
MODIFY HORA_PARTIDO DATE NOT NULL,
MODIFY COMPETICION VARCHAR2(30) NOT NULL,
MODIFY EQUIPO_LOCAL VARCHAR2(30) NOT NULL,
MODIFY EQUIPO_VISITANTE VARCHAR2(30) NOT NULL;


ALTER TABLE HISTORIAL_PARTIDOS
MODIFY MARCADOR_LOCAL NUMBER(2),
MODIFY MARCADOR_VISITANTE NUMBER(2);

ALTER TABLE HISTORIAL_PARTIDOS
MODIFY ESTADIO VARCHAR2(30) CONSTRAINT ESTADIO_LENGTH CHECK (LENGTH(ESTADIO) <= 30),
MODIFY ARBITRO VARCHAR2(30) CONSTRAINT ARBITRO_LENGTH CHECK (LENGTH(ARBITRO) <= 30);


ALTER TABLE TARJETAS_AMARILLAS_ROJAS
ADD CONSTRAINT PK_TARJETAS_AMARILLAS_ROJAS PRIMARY KEY (ID_SANCION);


ALTER TABLE TARJETAS_AMARILLAS_ROJAS
ADD CONSTRAINT FK_TARJETAS_PARTIDO
FOREIGN KEY (ID_PARTIDO) REFERENCES HISTORIAL_PARTIDOS(ID_PARTIDO);


ALTER TABLE TARJETAS_AMARILLAS_ROJAS
ADD CONSTRAINT FK_TARJETAS_JUGADOR
FOREIGN KEY (ID_JUGADOR) REFERENCES PLANTILLA_JUGADORES(ID_JUGADOR);






/*ELIMINAR TABLAS */


DROP TABLE LESIONES_JUGADORES;


DROP TABLE TARJETAS_AMARILLAS_ROJAS;


DROP TABLE HISTORIAL_PARTIDOS;


DROP TABLE PLANTILLA_JUGADORES;


DROP TABLE CUENTAS_BANCARIAS;






/*INSERCIONES SIN SELECT */

1)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (11, TO_DATE('2023-9-31', 'YYYY-MM-DD'), 3, 15, 3, 4);
2)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (12, TO_DATE('2023-10-31', 'YYYY-MM-DD'), 2, 11, 4, 3);
3)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (13, TO_DATE('2023-11-31', 'YYYY-MM-DD'), 1, 12, 1, 2);
4)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (40, TO_DATE('2024-01-01', 'YYYY-MM-DD'), 4, 10, 5, 5);
5)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (41, TO_DATE('2024-02-01', 'YYYY-MM-DD'), 4, 12, 3, 4);
6)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (42, TO_DATE('2024-03-01', 'YYYY-MM-DD'), 4, 8, 6, 6);
7)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (14, TO_DATE('2022-8-31', 'YYYY-MM-DD'), 4, 17, 2, 4);
8)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (12, TO_DATE('2022-9-17', 'YYYY-MM-DD'), 4, 22, 6, 3);
9)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (12, TO_DATE('2022-9-7', 'YYYY-MM-DD'), 5, 28, 6, 9);
10)INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
VALUES (12, TO_DATE('2022-9-13', 'YYYY-MM-DD'), 2, 29, 6, 4);



1)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (12,'TERINO',34568, 300, 5, 'JESUS');
2)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (15,'RODRIGUEZ',3458, 100, 2, 'PACO');
3)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (16,'BECERRA',3468, 200, 1, 'JUAN');
4)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (19,'GARCIA',7456, 700, 3, 'PEPE');
5)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (17,'LOPEZ',4788, 400, 2, 'ROBERTO');
6)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (7,'ZUZUNAGA',4576, 200, 3, 'AKSEL');
7)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (27,'SORNI',3458, 300, 5, 'ENZO');
8)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (47,'GARZA',4958, 300, 3, 'IKER');
9)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (11,'SANDEMETRIO',4868, 400, 2, 'OTTI');
10)INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
VALUES (23,'URRIAGA',4668, 500, 1, 'XELAI');

1)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (17,'JIMENEZ', 'JULIAN');
2)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (8,'HERNANDEZ', 'JULIA');
3)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (7,'IGLESIAS', 'SANDRA');
4)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (12,'CARMONA', 'PACA');
5)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (19,'GONZALEZ', 'JUAN PACO');
6)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (9,'ZAHERIE', 'AUXILIO');
7)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (11,'FULGA', 'PROCOPIO');
8)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (10,'VOINESCU', 'ACRACIO');
9)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (23,'LAPADAT', 'SEGISMUNDO');
10)INSERT INTO ENTRENADOR (N_IDENTIFICADOR,NOMBRE,APELLIDOS)
VALUES (26,'LASZLO', 'AFRODISIO');

1)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (23,86,25,8,2,7,2);
2)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (24,76,33,2,5,8,1);
3)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (25,36,31,6,4,6,4);
4)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (26,57,25,7,6,3,3);
5)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (27,46,15,4,5,8,7);
6)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (28,2,16,8,4,6,4);
7)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (29,23,19,3,8,4,2);
8)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (30,95,12,8,3,2,1);
9)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (31,87,17,7,1,7,0);
10)INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
VALUES (32,56,12,5,7,6,6);

1)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (1,'DIRECTOR','NAVARRO', 'NICO');
2)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (2,'SUBDIRECTOR','RAMOS', 'JUAN');
3)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (3,'ACCIONISTA','VELAZQUEZ', 'PACO');
4)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (4,'ACCIONISTA','LISBOA', 'PEPA');
5)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (5,'MINISTRO','FERNANDEZ', 'YODA');
6)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (6,'ACCIONISTA','IKENE', 'ELOY');
7)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (7,'MARKETING','CALEY', 'ELDEMIRO');
8)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (8,'MARKETING','JUBITERO', 'SIRO');
9)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (9,'ACCIONISTA','PACHAME', 'WALDO');
10)INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR,RESPONSABILIDAD,NOMBRE,APELLIDOS)
VALUES (10,'MINISTRO','CATAHUMBERT', 'IGOR');

1)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (1,SYSDATE,94,'SEVILLA');
2)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (2,SYSDATE,91,'CORDOBA');
3)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (3,SYSDATE,96,'HUELVA');
4)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (4,SYSDATE,92,'BADAJOZ');
5)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (5,SYSDATE,93,'BETIS');
6)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (6,SYSDATE,92,'ALMERIA');
7)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (7,SYSDATE,93,'MADRID');
8)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (8,SYSDATE,98,'GIRONA');
9)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (9,SYSDATE,94,'BARCELONA');
10)INSERT INTO PARTIDOS (CODIGO_PARTIDOS,DIA_PARTIDO,DURACION,EQUIPO_CONTRARIO)
VALUES (10,SYSDATE,90,'GETAFE');

1)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (43546,'ESTRELLA',23,'ESQUINA',3437);
2)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (46546,'ZAHIRA',13,'FUERA DEL CAMPO',5257);
3)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (47546,'WARDA',43,'GOL SUR',3737);
4)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (48546,'LEIRE',53,'GOL NORTE',9757);
5)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (49546,'PABLO',33,'GOL SUR ALTO',2457);
6)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (43346,'JUAN FRANCISCO',83,'ANFITEATRO',3458);
7)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (43646,'EDUARDO',53,'GOL NORTE',3467);
8)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (43846,'JESUS',43,'GOL SUR',3445);
9)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (43446,'MANUEL',43,'GOL SUR',3747);
10)INSERT INTO ENTRADA (N_ENTRADA,NOMBRE_COMPRADOR,PRECIO,ZONA,N_ASIENTO)
VALUES (43866,'ALFAJOR',43,'GOL SUR',3457);

/*MODIFICACIONES SIN SELECT */

UPDATE EQUIPO
SET N_TROFEOS = N_TROFEOS + 1
WHERE CODIGO_TROFEOS = 11;

UPDATE JUGADORES
SET SALARIO = SALARIO * 1.1
WHERE DORSAL = 12;

UPDATE ENTRENADOR
SET APELLIDOS = 'PÉREZ'
WHERE N_IDENTIFICADOR = 17;

UPDATE ESTADISTICAS
SET GOLES = GOLES + 2
WHERE N_PARTIDO = 27;

UPDATE EQUIPO_DIRECTIVO
SET RESPONSABILIDAD = 'MARKETING'
WHERE N_IDENTIFICADOR = 10;

UPDATE PARTIDOS
SET DURACION = DURACION + 10
WHERE CODIGO_PARTIDOS = 2;

UPDATE ENTRADA
SET PRECIO = PRECIO * 0.9
WHERE ZONA = 'GOL SUR';


/*ELIMINACIONES SIN SELECT */

DELETE FROM EQUIPO
WHERE DIA_DEL_AÑO = TO_DATE('2022-08-31', 'YYYY-MM-DD');

DELETE FROM JUGADORES
WHERE DORSAL = 19;

DELETE FROM ENTRENADOR
WHERE N_IDENTIFICADOR = 8;

DELETE FROM ESTADISTICAS
WHERE N_PARTIDO = 23;

DELETE FROM EQUIPO_DIRECTIVO
WHERE RESPONSABILIDAD = 'MINISTRO';

DELETE FROM PARTIDOS
WHERE CODIGO_PARTIDOS = 1;

DELETE FROM ENTRADA
WHERE ZONA = 'FUERA DEL CAMPO';


/*INSERCIONES CON SELECT */

INSERT INTO EQUIPO (CODIGO_TROFEOS, DIA_DEL_AÑO, N_TROFEOS, N_VICTORIAS, N_EMPATES, N_DERROTAS)
SELECT 
    MAX(CODIGO_TROFEOS) + 1 AS CODIGO_TROFEOS,
    TO_DATE('2024-06-01', 'YYYY-MM-DD') AS DIA_DEL_AÑO,
    LEAST(SUM(N_TROFEOS), 99) AS N_TROFEOS,
    LEAST(SUM(N_VICTORIAS), 99) AS N_VICTORIAS,
    LEAST(SUM(N_EMPATES), 99) AS N_EMPATES,
    LEAST(SUM(N_DERROTAS), 99) AS N_DERROTAS
FROM 
    EQUIPO;



INSERT INTO JUGADORES (DORSAL,APELLIDOS,SALARIO,BONIFICACIONES,DURACION_CONTRATO,NOMBRE)
SELECT N_IDENTIFICADOR, APELLIDOS, SALARIO, 0, 1, NOMBRE
FROM ENTRENADOR;


INSERT INTO ENTRENADOR (N_IDENTIFICADOR, NOMBRE, APELLIDOS)
SELECT N_IDENTIFICADOR, NOMBRE, APELLIDOS
FROM EQUIPO_DIRECTIVO
WHERE RESPONSABILIDAD = 'ENTRENADOR';


INSERT INTO ESTADISTICAS (N_PARTIDO,TIEMPO_JUGADO,PASES_COMPLETADOS,POSESIONES_RECUPERADAS,POSESIONES_PERDIDAS,DISTANCIA_RECORRIDA,GOLES)
SELECT CODIGO_PARTIDOS, TIEMPO_JUGADO, PASES_COMPLETADOS, POSESIONES_RECUPERADAS, POSESIONES_PERDIDAS, DISTANCIA_RECORRIDA, GOLES
FROM PARTIDOS;


INSERT INTO EQUIPO_DIRECTIVO (N_IDENTIFICADOR, RESPONSABILIDAD, NOMBRE, APELLIDOS)
SELECT N_IDENTIFICADOR, 'ACCIONISTA', NOMBRE_COMPRADOR, APELLIDO_COMPRADOR
FROM ENTRADA
GROUP BY N_IDENTIFICADOR


INSERT INTO JUGADORES (DORSAL, APELLIDOS, SALARIO, BONIFICACIONES, DURACION_CONTRATO, NOMBRE)
SELECT E.CODIGO_TROFEOS AS DORSAL, E.N_TROFEOS AS APELLIDOS, P.DURACION * 100 AS SALARIO, 0, 1, CONCAT('JUGADOR', E.CODIGO_TROFEOS) AS NOMBRE
FROM EQUIPO E
INNER JOIN PARTIDOS P ON E.DIA_DEL_AÑO = P.DIA_PARTIDO;


INSERT INTO ENTRENADOR (N_IDENTIFICADOR, NOMBRE, APELLIDOS)
SELECT J.DORSAL AS N_IDENTIFICADOR, 'ENTRENADOR' AS NOMBRE, J.APELLIDOS
FROM JUGADORES J
WHERE J.SALARIO > 5000;


INSERT INTO ESTADISTICAS (N_PARTIDO, TIEMPO_JUGADO, PASES_COMPLETADOS, POSESIONES_RECUPERADAS, POSESIONES_PERDIDAS, DISTANCIA_RECORRIDA, GOLES)
SELECT ED.N_IDENTIFICADOR * 10, 0, 0, 0, 0, 0, 0
FROM EQUIPO_DIRECTIVO ED;


INSERT INTO PARTIDOS (CODIGO_PARTIDOS, DIA_PARTIDO, DURACION, EQUIPO_CONTRARIO)
SELECT N_ENTRADA, SYSDATE, 90, 'EQUIPO DESCONOCIDO'
FROM ENTRADA
WHERE ZONA = 'GOL SUR ALTO';


/*MODIFICACIONES CON SELECT */

UPDATE EQUIPO E
SET N_TROFEOS = (SELECT COUNT(*) FROM JUGADORES J WHERE J.SALARIO > 3000 AND E.DIA_DEL_AÑO = J.DIA_DEL_AÑO)
WHERE E.CODIGO_TROFEOS = 1;

UPDATE JUGADORES J
SET SALARIO = (SELECT E.SALARIO * 0.8 FROM ENTRENADOR E WHERE E.N_IDENTIFICADOR = J.DORSAL)
WHERE J.DORSAL IN (SELECT N_IDENTIFICADOR FROM ENTRENADOR);

UPDATE ENTRENADOR E
SET APELLIDOS = UPPER(SUBSTR(ED.APELLIDOS, 1, 3)) || ED.NOMBRE
FROM EQUIPO_DIRECTIVO ED
WHERE E.N_IDENTIFICADOR = ED.N_IDENTIFICADOR;

UPDATE ESTADISTICAS E
SET GOLES = E.GOLES + (
    SELECT COUNT(*) 
    FROM PARTIDOS P 
    WHERE P.CODIGO_PARTIDOS = E.N_PARTIDO AND P.N_ROJAS > 0
)
WHERE EXISTS (
    SELECT 1
    FROM PARTIDOS P
    WHERE P.CODIGO_PARTIDOS = E.N_PARTIDO AND P.N_ROJAS > 0
);


UPDATE EQUIPO_DIRECTIVO ED
SET RESPONSABILIDAD = 'DIRECTOR'
WHERE ED.N_IDENTIFICADOR IN (
    SELECT DISTINCT N_IDENTIFICADOR
    FROM ENTRADA E
    WHERE E.ZONA = 'GOL SUR ALTO' AND E.CANTIDAD > 100
);
UPDATE PARTIDOS P
SET DURACION = DURACION + (SELECT J.SALARIO / 1000 FROM JUGADORES J WHERE J.DORSAL = P.N_JUGADOR_EQUIPO_LOCAL)
WHERE P.N_JUGADOR_EQUIPO_LOCAL IN (
    SELECT DORSAL FROM JUGADORES WHERE SALARIO > 5000
);

UPDATE ENTRADA E
SET PRECIO = PRECIO * 1.2
WHERE E.N_PARTIDO IN (
  SELECT CODIGO_PARTIDOS
  FROM PARTIDOS P
  WHERE P.GOLES > (SELECT AVG(GOLES) FROM ESTADISTICAS)
);



/*ELIMINACIONES CON SELECT */

DELETE FROM EQUIPO E
WHERE E.CODIGO_TROFEOS NOT IN (
  SELECT J.SALARIO AS CODIGO_TROFEOS
  FROM JUGADORES J
  WHERE J.SALARIO > 3000
);


DELETE FROM JUGADORES J
WHERE J.DORSAL NOT IN (
  SELECT N_IDENTIFICADOR
  FROM ENTRENADOR
);


DELETE FROM ENTRENADOR E
WHERE E.N_IDENTIFICADOR NOT IN (
  SELECT N_IDENTIFICADOR
  FROM EQUIPO_DIRECTIVO
  WHERE RESPONSABILIDAD = 'ENTRENADOR'
);


DELETE FROM ESTADISTICAS E
WHERE E.N_PARTIDO NOT IN (
  SELECT CODIGO_PARTIDOS
  FROM PARTIDOS
);


DELETE FROM EQUIPO_DIRECTIVO ED
WHERE ED.N_IDENTIFICADOR NOT IN (
  SELECT DISTINCT N_IDENTIFICADOR
  FROM ENTRADA E
  WHERE E.ZONA = 'GOL SUR ALTO' AND E.CANTIDAD > 100
);


DELETE FROM PARTIDOS P
WHERE P.N_JUGADOR_EQUIPO_LOCAL NOT IN (
  SELECT DORSAL
  FROM JUGADORES
  WHERE SALARIO > 5000
);


DELETE FROM ENTRADA E
WHERE E.N_PARTIDO NOT IN (
  SELECT E.N_PARTIDO
  FROM PARTIDOS P
  INNER JOIN ESTADISTICAS ES ON P.CODIGO_PARTIDOS = ES.N_PARTIDO
  WHERE ES.GOLES > 0
);






